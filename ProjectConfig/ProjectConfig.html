<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¡¹ç›®é…ç½® - AIåŠ¨æ¼«åˆ›ä½œå¹³å°</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- åŠ¨æ€å…‰é›¾èƒŒæ™¯ -->
    <div class="light-fog-container"></div>
    
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <header class="header">
        <div class="nav-container">
            <div class="logo-text">AIåŠ¨æ¼«åˆ›ä½œå¹³å°</div>
            <nav class="nav-menu">
                <a href="../home/index.html" class="nav-link">é¦–é¡µ</a>
                <a href="index.html" class="nav-link">åˆ›å»ºé¡¹ç›®</a>
                <a href="#" class="nav-link">æˆ‘çš„é¡¹ç›®</a>
            </nav>
        </div>
    </header>
    
    <!-- ä¸»è¦å†…å®¹ -->
    <main class="main-content">
        <div class="container">
            <!-- é¡µé¢æ ‡é¢˜ -->
            <div class="page-header">
                <h1 class="page-title">
                    é¡¹ç›®<span class="ai-text">é…ç½®</span>
                </h1>
                <p class="page-subtitle">
                    æ ¹æ®æ‚¨çš„é€‰æ‹©é…ç½®é¡¹ç›®è¯¦ç»†ä¿¡æ¯
                </p>
            </div>
            
            <!-- é€‰æ‹©å›é¡¾ -->
            <section class="selection-review">
                <h2 class="section-title">æ‚¨çš„é€‰æ‹©</h2>
                <div class="review-cards">
                    <div class="review-card" id="route-review">
                        <div class="review-icon">ğŸ“š</div>
                        <div class="review-content">
                            <h3>åˆ›ä½œè·¯çº¿</h3>
                            <p id="selected-route-text">å°è¯´ç”ŸæˆåŠ¨æ¼«</p>
                        </div>
                    </div>
                    <div class="review-card" id="mode-review">
                        <div class="review-icon">âš¡</div>
                        <div class="review-content">
                            <h3>åˆ¶ä½œæ¨¡å¼</h3>
                            <p id="selected-mode-text">å¿«é€Ÿæ¨¡å¼</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- é¡¹ç›®åŸºæœ¬ä¿¡æ¯ -->
            <section class="project-info">
                <h2 class="section-title">é¡¹ç›®ä¿¡æ¯</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="project-name">é¡¹ç›®åç§°</label>
                        <input type="text" id="project-name" placeholder="è¯·è¾“å…¥é¡¹ç›®åç§°" required>
                    </div>
                    <div class="form-group">
                        <label for="project-description">é¡¹ç›®æè¿°</label>
                        <textarea id="project-description" placeholder="ç®€è¦æè¿°æ‚¨çš„é¡¹ç›®å†…å®¹å’Œé£æ ¼" rows="3"></textarea>
                    </div>
                </div>
            </section>
            
            <!-- å†…å®¹è¾“å…¥åŒºåŸŸ -->
            <section class="content-input" id="content-section">
                <h2 class="section-title">å†…å®¹è¾“å…¥</h2>
                <div class="content-form" id="novel-form">
                    <div class="form-group">
                        <label for="novel-content">å°è¯´å†…å®¹</label>
                        <textarea id="novel-content" placeholder="è¯·ç²˜è´´æˆ–è¾“å…¥æ‚¨çš„å°è¯´å†…å®¹..." rows="8"></textarea>
                        <div class="form-hint">æ”¯æŒæ–‡æœ¬æ ¼å¼ï¼Œå»ºè®®å­—æ•°åœ¨1000-10000å­—ä¹‹é—´</div>
                    </div>
                    <div class="form-group">
                        <label for="novel-file">æˆ–ä¸Šä¼ å°è¯´æ–‡ä»¶</label>
                        <div class="file-upload">
                            <input type="file" id="novel-file" accept=".txt,.doc,.docx" hidden>
                            <button type="button" class="btn btn-secondary" onclick="document.getElementById('novel-file').click()">
                                é€‰æ‹©æ–‡ä»¶
                            </button>
                            <span class="file-name" id="novel-file-name">æœªé€‰æ‹©æ–‡ä»¶</span>
                        </div>
                    </div>
                </div>
                
                <div class="content-form" id="script-form" style="display: none;">
                    <div class="form-group">
                        <label for="script-content">çŸ­å‰§å‰§æœ¬</label>
                        <textarea id="script-content" placeholder="è¯·è¾“å…¥æ‚¨çš„çŸ­å‰§å‰§æœ¬å†…å®¹..." rows="8"></textarea>
                        <div class="form-hint">è¯·æŒ‰ç…§æ ‡å‡†å‰§æœ¬æ ¼å¼è¾“å…¥ï¼ŒåŒ…å«åœºæ™¯ã€å¯¹è¯å’ŒåŠ¨ä½œæè¿°</div>
                    </div>
                    <div class="form-group">
                        <label for="script-file">æˆ–ä¸Šä¼ å‰§æœ¬æ–‡ä»¶</label>
                        <div class="file-upload">
                            <input type="file" id="script-file" accept=".txt,.doc,.docx,.pdf" hidden>
                            <button type="button" class="btn btn-secondary" onclick="document.getElementById('script-file').click()">
                                é€‰æ‹©æ–‡ä»¶
                            </button>
                            <span class="file-name" id="script-file-name">æœªé€‰æ‹©æ–‡ä»¶</span>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- è§’è‰²é…ç½® -->
            <section class="character-config" id="character-section">
                <h2 class="section-title">è§’è‰²é…ç½®</h2>
                <div class="character-limit-info" id="character-limit">
                    <p>å½“å‰æ¨¡å¼æ”¯æŒé…ç½® <span class="limit-number">3</span> ä¸ªä¸»è¦è§’è‰²</p>
                </div>
                <div class="character-list" id="character-list">
                    <!-- è§’è‰²é…ç½®é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
                <button type="button" class="btn btn-secondary" id="add-character-btn">
                    + æ·»åŠ è§’è‰²
                </button>
            </section>
            
            <!-- é£æ ¼é…ç½® -->
            <section class="style-config" id="style-section">
                <h2 class="section-title">é£æ ¼é…ç½®</h2>
                <div class="style-options">
                    <div class="style-presets">
                        <h3>é¢„è®¾é£æ ¼</h3>
                        <div class="preset-grid">
                            <div class="preset-card" data-style="anime">
                                <div class="preset-preview">ğŸŒ</div>
                                <h4>æ—¥å¼åŠ¨æ¼«</h4>
                                <p>ç»å…¸æ—¥æœ¬åŠ¨æ¼«é£æ ¼</p>
                            </div>
                            <div class="preset-card" data-style="realistic">
                                <div class="preset-preview">ğŸ­</div>
                                <h4>å†™å®é£æ ¼</h4>
                                <p>æ¥è¿‘çœŸäººçš„å†™å®ç”»é£</p>
                            </div>
                            <div class="preset-card" data-style="cartoon">
                                <div class="preset-preview">ğŸ¨</div>
                                <h4>å¡é€šé£æ ¼</h4>
                                <p>å¯çˆ±çš„å¡é€šç”»é£</p>
                            </div>
                            <div class="preset-card" data-style="fantasy">
                                <div class="preset-preview">âœ¨</div>
                                <h4>å¥‡å¹»é£æ ¼</h4>
                                <p>é­”å¹»å¥‡å¹»ä¸»é¢˜é£æ ¼</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="custom-style" id="custom-style-section" style="display: none;">
                        <h3>è‡ªå®šä¹‰é£æ ¼</h3>
                        <div class="form-group">
                            <label for="style-description">é£æ ¼æè¿°</label>
                            <textarea id="style-description" placeholder="è¯¦ç»†æè¿°æ‚¨æƒ³è¦çš„ç”»é¢é£æ ¼..." rows="4"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="reference-images">å‚è€ƒå›¾ç‰‡</label>
                            <div class="file-upload">
                                <input type="file" id="reference-images" accept="image/*" multiple hidden>
                                <button type="button" class="btn btn-secondary" onclick="document.getElementById('reference-images').click()">
                                    é€‰æ‹©å›¾ç‰‡
                                </button>
                                <span class="file-name" id="reference-images-name">æœªé€‰æ‹©æ–‡ä»¶</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- é«˜çº§è®¾ç½® -->
            <section class="advanced-settings" id="advanced-section" style="display: none;">
                <h2 class="section-title">é«˜çº§è®¾ç½®</h2>
                <div class="settings-grid">
                    <div class="setting-group">
                        <label for="video-quality">è§†é¢‘è´¨é‡</label>
                        <select id="video-quality">
                            <option value="720p">720p (æ ‡å‡†)</option>
                            <option value="1080p" selected>1080p (é«˜æ¸…)</option>
                            <option value="4k">4K (è¶…é«˜æ¸…)</option>
                        </select>
                    </div>
                    <div class="setting-group">
                        <label for="frame-rate">å¸§ç‡</label>
                        <select id="frame-rate">
                            <option value="24">24 FPS</option>
                            <option value="30" selected>30 FPS</option>
                            <option value="60">60 FPS</option>
                        </select>
                    </div>
                    <div class="setting-group">
                        <label for="video-length">é¢„æœŸæ—¶é•¿ (åˆ†é’Ÿ)</label>
                        <input type="number" id="video-length" min="1" max="60" value="5">
                    </div>
                </div>
            </section>
            
            <!-- æ“ä½œæŒ‰é’® -->
            <div class="action-section">
                <div class="action-buttons">
                    <button type="button" class="btn btn-secondary" id="back-to-selection">
                        è¿”å›é€‰æ‹©
                    </button>
                    <button type="button" class="btn btn-secondary" id="save-draft">
                        ä¿å­˜è‰ç¨¿
                    </button>
                    <button type="button" class="btn btn-primary" id="start-creation">
                        å¼€å§‹åˆ›ä½œ
                    </button>
                </div>
            </div>
        </div>
    </main>
    
    <script src="script.js"></script>
    <script>
        // é¡¹ç›®é…ç½®é¡µé¢ç‰¹å®šçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initProjectConfig();
        });
        
        function initProjectConfig() {
            // ä»ä¼šè¯å­˜å‚¨ä¸­è·å–ä¹‹å‰çš„é€‰æ‹©
            const selectedRoute = sessionStorage.getItem('selectedRoute');
            const selectedMode = sessionStorage.getItem('selectedMode');
            
            // æ›´æ–°é€‰æ‹©å›é¡¾
            updateSelectionReview(selectedRoute, selectedMode);
            
            // æ ¹æ®é€‰æ‹©æ˜¾ç¤ºç›¸åº”çš„é…ç½®é€‰é¡¹
            configurePageBySelection(selectedRoute, selectedMode);
            
            // åˆå§‹åŒ–è§’è‰²é…ç½®
            initCharacterConfig();
            
            // åˆå§‹åŒ–æ–‡ä»¶ä¸Šä¼ 
            initFileUploads();
            
            // åˆå§‹åŒ–æŒ‰é’®äº‹ä»¶
            initConfigButtons();
        }
        
        function updateSelectionReview(route, mode) {
            const routeText = document.getElementById('selected-route-text');
            const modeText = document.getElementById('selected-mode-text');
            
            if (route) {
                routeText.textContent = route === 'novel' ? 'å°è¯´ç”ŸæˆåŠ¨æ¼«' : 'çŸ­å‰§æ”¹ç¼–åŠ¨æ¼«';
            }
            
            if (mode) {
                const modeNames = {
                    'fast': 'å¿«é€Ÿæ¨¡å¼',
                    'standard': 'æ ‡å‡†æ¨¡å¼',
                    'advanced': 'é«˜çº§æ¨¡å¼'
                };
                modeText.textContent = modeNames[mode] || mode;
            }
        }
        
        function configurePageBySelection(route, mode) {
            // æ ¹æ®è·¯çº¿æ˜¾ç¤ºç›¸åº”çš„å†…å®¹è¾“å…¥è¡¨å•
            if (route === 'novel') {
                document.getElementById('novel-form').style.display = 'block';
                document.getElementById('script-form').style.display = 'none';
            } else if (route === 'script') {
                document.getElementById('novel-form').style.display = 'none';
                document.getElementById('script-form').style.display = 'block';
            }
            
            // æ ¹æ®æ¨¡å¼é…ç½®è§’è‰²é™åˆ¶å’Œé«˜çº§è®¾ç½®
            const characterLimit = document.querySelector('.limit-number');
            const advancedSection = document.getElementById('advanced-section');
            const customStyleSection = document.getElementById('custom-style-section');
            
            if (mode === 'fast') {
                characterLimit.textContent = '1';
                advancedSection.style.display = 'none';
                customStyleSection.style.display = 'none';
            } else if (mode === 'standard') {
                characterLimit.textContent = '3';
                advancedSection.style.display = 'block';
                customStyleSection.style.display = 'none';
            } else if (mode === 'advanced') {
                characterLimit.textContent = 'æ— é™åˆ¶';
                advancedSection.style.display = 'block';
                customStyleSection.style.display = 'block';
            }
        }
        
        function initCharacterConfig() {
            const addCharacterBtn = document.getElementById('add-character-btn');
            const characterList = document.getElementById('character-list');
            let characterCount = 0;
            
            addCharacterBtn.addEventListener('click', function() {
                const selectedMode = sessionStorage.getItem('selectedMode');
                const maxCharacters = selectedMode === 'fast' ? 1 : (selectedMode === 'standard' ? 3 : Infinity);
                
                if (characterCount >= maxCharacters) {
                    showNotification('å·²è¾¾åˆ°å½“å‰æ¨¡å¼çš„è§’è‰²æ•°é‡é™åˆ¶', 'warning');
                    return;
                }
                
                characterCount++;
                const characterItem = createCharacterItem(characterCount);
                characterList.appendChild(characterItem);
                
                if (characterCount >= maxCharacters) {
                    addCharacterBtn.style.display = 'none';
                }
            });
        }
        
        function createCharacterItem(index) {
            const div = document.createElement('div');
            div.className = 'character-item';
            div.innerHTML = `
                <div class="character-header">
                    <h4>è§’è‰² ${index}</h4>
                    <button type="button" class="remove-character" onclick="removeCharacter(this)">
                        Ã—
                    </button>
                </div>
                <div class="character-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label>è§’è‰²åç§°</label>
                            <input type="text" placeholder="è§’è‰²åç§°" required>
                        </div>
                        <div class="form-group">
                            <label>è§’è‰²æè¿°</label>
                            <textarea placeholder="æè¿°è§’è‰²çš„å¤–è²Œã€æ€§æ ¼ç­‰ç‰¹å¾" rows="2"></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>å‚è€ƒå›¾ç‰‡</label>
                        <div class="file-upload">
                            <input type="file" accept="image/*" multiple hidden>
                            <button type="button" class="btn btn-secondary" onclick="this.previousElementSibling.click()">
                                é€‰æ‹©å›¾ç‰‡
                            </button>
                            <span class="file-name">æœªé€‰æ‹©æ–‡ä»¶</span>
                        </div>
                    </div>
                </div>
            `;
            return div;
        }
        
        function removeCharacter(button) {
            const characterItem = button.closest('.character-item');
            characterItem.remove();
            
            // é‡æ–°æ˜¾ç¤ºæ·»åŠ æŒ‰é’®
            const addCharacterBtn = document.getElementById('add-character-btn');
            addCharacterBtn.style.display = 'inline-flex';
            
            // æ›´æ–°è§’è‰²è®¡æ•°
            const characterItems = document.querySelectorAll('.character-item');
            characterItems.forEach((item, index) => {
                const header = item.querySelector('.character-header h4');
                header.textContent = `è§’è‰² ${index + 1}`;
            });
        }
        
        function initFileUploads() {
            // å¤„ç†æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ 
            const fileInputs = document.querySelectorAll('input[type="file"]');
            fileInputs.forEach(input => {
                input.addEventListener('change', function() {
                    const fileNameSpan = this.parentElement.querySelector('.file-name');
                    if (this.files.length > 0) {
                        if (this.files.length === 1) {
                            fileNameSpan.textContent = this.files[0].name;
                        } else {
                            fileNameSpan.textContent = `å·²é€‰æ‹© ${this.files.length} ä¸ªæ–‡ä»¶`;
                        }
                    } else {
                        fileNameSpan.textContent = 'æœªé€‰æ‹©æ–‡ä»¶';
                    }
                });
            });
        }
        
        function initConfigButtons() {
            // è¿”å›é€‰æ‹©é¡µé¢
            document.getElementById('back-to-selection').addEventListener('click', function() {
                window.location.href = 'index.html';
            });
            
            // ä¿å­˜è‰ç¨¿
            document.getElementById('save-draft').addEventListener('click', function() {
                showNotification('è‰ç¨¿ä¿å­˜åŠŸèƒ½å³å°†ä¸Šçº¿ï¼', 'info');
            });
            
            // å¼€å§‹åˆ›ä½œ
            document.getElementById('start-creation').addEventListener('click', function() {
                if (validateForm()) {
                    showNotification('é¡¹ç›®åˆ›å»ºæˆåŠŸï¼æ­£åœ¨å‡†å¤‡åˆ›ä½œç¯å¢ƒ...', 'success');
                    // è¿™é‡Œå¯ä»¥æ·»åŠ å®é™…çš„é¡¹ç›®åˆ›å»ºé€»è¾‘
                    setTimeout(() => {
                        showNotification('åˆ›ä½œåŠŸèƒ½å³å°†ä¸Šçº¿ï¼Œæ•¬è¯·æœŸå¾…ï¼', 'info');
                    }, 2000);
                }
            });
        }
        
        function validateForm() {
            const projectName = document.getElementById('project-name').value.trim();
            if (!projectName) {
                showNotification('è¯·è¾“å…¥é¡¹ç›®åç§°', 'error');
                return false;
            }
            
            const selectedRoute = sessionStorage.getItem('selectedRoute');
            if (selectedRoute === 'novel') {
                const novelContent = document.getElementById('novel-content').value.trim();
                const novelFile = document.getElementById('novel-file').files.length;
                if (!novelContent && !novelFile) {
                    showNotification('è¯·è¾“å…¥å°è¯´å†…å®¹æˆ–ä¸Šä¼ å°è¯´æ–‡ä»¶', 'error');
                    return false;
                }
            } else if (selectedRoute === 'script') {
                const scriptContent = document.getElementById('script-content').value.trim();
                const scriptFile = document.getElementById('script-file').files.length;
                if (!scriptContent && !scriptFile) {
                    showNotification('è¯·è¾“å…¥å‰§æœ¬å†…å®¹æˆ–ä¸Šä¼ å‰§æœ¬æ–‡ä»¶', 'error');
                    return false;
                }
            }
            
            return true;
        }
    </script>
</body>
</html>